<idea-plugin>
    <id>nl.akiar.pascal</id>
    <name>Delphi Pascal</name>
    <version>0.0.3</version>
    <vendor>Akiar</vendor>

    <description><![CDATA[
    Provides syntax highlighting and code folding support for Delphi/Object Pascal and Delphi Form (DFM) files.

    <b>Object Pascal Support (.pas, .dpr, .dpk):</b>
    - Full syntax highlighting for Delphi/Object Pascal
    - All Pascal keywords and operators highlighted
    - Compiler directive highlighting ({$...})
    - Code folding for begin..end, class, record, try..except/finally, case, repeat..until
    - Code folding for interface/implementation sections
    - Customizable colors via Settings

    <b>DFM Support (.dfm):</b>
    - Syntax highlighting for keywords, properties, object names, class names
    - String, number, and boolean literal highlighting
    - Comment highlighting (// and {...} and (*...*))
    - Code folding for object...end and item...end blocks
    - Customizable colors via Settings
    ]]></description>

    <change-notes><![CDATA[
    Version 0.0.3:
    - Settings: when Pascal source paths or unit scope names change, the plugin triggers a reindex of configured directories so type/variable indices and semantic features update immediately.
    - Object Pascal: syntax highlighting (keywords/operators/compiler directives), code folding (begin/end, class, record, try..except/finally, case, repeat..until, interface/implementation sections), configurable colors, semantic annotator, uses clause annotator, documentation provider, go to declaration, reference contributor, stub indices for types and variables.
    - DFM: syntax highlighting (keywords/properties/object names/class names), literals and comments, code folding for object/item blocks, configurable colors.

    Version 0.0.2:
    - Object Pascal (.pas, .dpr, .dpk): syntax highlighting, compiler directive highlighting, code folding for major block types, interface/implementation folding, configurable colors
    - DFM (.dfm): syntax highlighting for keywords/properties/object and class names, literals and comments, code folding for object/item blocks, configurable colors

    Version 0.0.1:
    - Initial release with DFM and Object Pascal support: basic syntax highlighting and code folding, configurable colors
    ]]></change-notes>

    <!-- IntelliJ Platform compatibility -->
    <idea-version since-build="253"/>

    <!-- Plugin dependencies -->
    <depends>com.intellij.modules.platform</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- ==================== DFM Support ==================== -->

        <!-- DFM File Type -->
        <fileType name="Delphi Form" implementationClass="nl.akiar.pascal.dfm.DfmFileType"
                  fieldName="INSTANCE" language="DFM" extensions="dfm"/>

        <!-- DFM Parser Definition -->
        <lang.parserDefinition language="DFM"
                               implementationClass="nl.akiar.pascal.dfm.DfmParserDefinition"/>

        <!-- DFM Syntax Highlighter -->
        <lang.syntaxHighlighterFactory language="DFM"
                                       implementationClass="nl.akiar.pascal.dfm.DfmSyntaxHighlighterFactory"/>

        <!-- DFM Code Folding -->
        <lang.foldingBuilder language="DFM"
                            implementationClass="nl.akiar.pascal.dfm.DfmFoldingBuilder"/>

        <!-- DFM Color Settings Page -->
        <colorSettingsPage implementation="nl.akiar.pascal.dfm.DfmColorSettingsPage"/>

        <!-- ==================== Pascal Support ==================== -->

        <!-- Pascal File Type -->
        <fileType name="Object Pascal" implementationClass="nl.akiar.pascal.PascalFileType"
                  fieldName="INSTANCE" language="ObjectPascal" extensions="pas;dpr;dpk"/>

        <!-- Pascal Parser Definition -->
        <lang.parserDefinition language="ObjectPascal"
                               implementationClass="nl.akiar.pascal.PascalParserDefinition"/>

        <!-- Pascal Syntax Highlighter -->
        <lang.syntaxHighlighterFactory language="ObjectPascal"
                                       implementationClass="nl.akiar.pascal.PascalSyntaxHighlighterFactory"/>

        <!-- Pascal Code Folding -->
        <lang.foldingBuilder language="ObjectPascal"
                            implementationClass="nl.akiar.pascal.PascalFoldingBuilder"/>

        <!-- Pascal Color Settings Page -->
        <colorSettingsPage implementation="nl.akiar.pascal.PascalColorSettingsPage"/>

        <!-- Pascal Stub Index for type definitions -->
        <stubIndex implementation="nl.akiar.pascal.stubs.PascalTypeIndex"/>

        <!-- Pascal Stub Index for variable definitions -->
        <stubIndex implementation="nl.akiar.pascal.stubs.PascalVariableIndex"/>

        <!-- Pascal Stub Index for routine definitions -->
        <stubIndex implementation="nl.akiar.pascal.stubs.PascalRoutineIndex"/>

        <!-- Pascal Stub Index for property definitions -->
        <stubIndex implementation="nl.akiar.pascal.stubs.PascalPropertyIndex"/>

        <!-- Pascal Stub Element Types Holder -->
        <stubElementTypeHolder class="nl.akiar.pascal.psi.PascalElementTypes"/>

        <!-- Pascal Unit Name Index -->
        <fileBasedIndex implementation="nl.akiar.pascal.index.PascalUnitIndex"/>

        <!-- Pascal Semantic Annotator for type coloring -->
        <annotator language="ObjectPascal"
                   implementationClass="nl.akiar.pascal.annotator.PascalSemanticAnnotator"/>

        <!-- Pascal Uses Clause Annotator for error highlighting -->
        <annotator language="ObjectPascal"
                   implementationClass="nl.akiar.pascal.annotator.PascalUsesClauseAnnotator"/>

        <!-- Pascal Documentation Provider for hover documentation -->
        <lang.documentationProvider language="ObjectPascal"
                                    implementationClass="nl.akiar.pascal.documentation.PascalDocumentationProvider"/>

        <!-- Pascal Symbol Navigation (Go to Declaration) -->
        <psi.referenceContributor language="ObjectPascal"
                                  implementation="nl.akiar.pascal.reference.PascalReferenceContributor"/>

        <!-- Pascal Go to Declaration Handler (Cmd+Click navigation) -->
        <gotoDeclarationHandler implementation="nl.akiar.pascal.navigation.PascalGotoDeclarationHandler"/>

        <!-- DPR Library Roots Provider - indexes files referenced by .dpr files -->
        <additionalLibraryRootsProvider implementation="nl.akiar.pascal.dpr.DprLibraryRootsProvider"/>

        <!-- Pascal Source Paths Settings Page -->
        <projectConfigurable
            id="pascal.sourcePaths"
            parentId="language"
            displayName="Pascal Source Paths"
            instance="nl.akiar.pascal.settings.PascalSourcePathsConfigurable"/>

        <postStartupActivity implementation="nl.akiar.pascal.project.PascalProjectInitializationActivity"/>
    </extensions>

    <projectListeners>
        <listener class="nl.akiar.pascal.project.PascalFileEditorListener"
                  topic="com.intellij.openapi.fileEditor.FileEditorManagerListener"/>
    </projectListeners>
</idea-plugin>
